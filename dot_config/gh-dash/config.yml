# yaml-language-server: $schema=https://gh-dash.dev/schema.json
prSections:
  - title: üöÄ My PRs
    filters: is:open assignee:@me -is:draft sort:created-desc
  - title: üìù My draft PRs
    filters: is:open assignee:@me is:draft sort:created-desc
  - title: üÜï Review requested
    filters: is:open -assignee:@me review-requested:@me -is:draft sort:created-desc updated:>={{ nowModify "-4w" }} -author:renovate[bot] -author:github-actions[bot] -author:dependabot[bot] -author:onomondo-org
  - title: üï∏Ô∏è Review requested
    filters: is:open -assignee:@me review-requested:@me -is:draft sort:created-desc updated:<{{ nowModify "-4w" }} -author:renovate[bot] -author:github-actions[bot] -author:dependabot[bot] -author:onomondo-org
  - title: üëÄ Involves me
    filters: is:open -assignee:@me involves:@me -is:draft sort:created-desc -author:renovate[bot] -author:github-actions[bot] -author:dependabot[bot]
  - title: ‚úÖ Ready
    filters: is:open -assignee:@me -is:draft sort:created-desc org:onomondo -author:renovate[bot] -author:github-actions[bot] -author:dependabot[bot]
  - title: üöß Draft
    filters: is:open -assignee:@me is:draft sort:created-desc org:onomondo
  - title: üîí Recently closed my PRs
    filters: is:closed author:@me sort:created-desc
  - title: üì¶ Recently closed work PRs
    filters: is:closed sort:created-desc org:onomondo -author:renovate[bot] -author:github-actions[bot] -author:dependabot[bot]
  - title: üîß My PRs but not assigned to me
    filters: is:open author:joelazar -assignee:@me sort:created-desc
issuesSections:
  - title: üìã My Issues
    filters: is:open author:@me
  - title: üéØ Assigned
    filters: is:open assignee:@me
notificationsSections:
  - title: üì¨ All
    filters: ""
  - title: üÜï Review Requested
    filters: "reason:review-requested"
  - title: üí¨ Participating
    filters: "reason:participating"
  - title: üì£ Mentioned
    filters: "reason:mention"
  - title: ‚úçÔ∏è Created
    filters: "reason:author"
  - title: üè∑Ô∏è Assigned
    filters: "reason:assign"
  - title: üë• Team Mentioned
    filters: "reason:team-mention"
  - title: üîî Subscribed
    filters: "reason:subscribed"
defaults:
  preview:
    open: true
    width: 80
  prsLimit: 20
  issuesLimit: 20
  notificationsLimit: 40
  view: prs
  prApproveComment: ""
  dateFormat: relative
  refetchIntervalMinutes: 10
  layout:
    prs:
      updatedAt:
        width: 7
      repo:
        width: 15
      author:
        width: 15
      assignees:
        width: 20
        hidden: true
      base:
        width: 15
        hidden: true
      lines:
        width: 16
    issues:
      updatedAt:
        width: 7
      repo:
        width: 15
      creator:
        width: 10
      assignees:
        width: 20
        hidden: true
repoPaths:
  onomondo/*: ~/Code/onomondo/*
pager:
  diff: diffnav
showAuthorIcons: true
smartFilteringAtLaunch: true
confirmQuit: true
keybindings:
  universal:
    - key: g
      command: >
        cd {{.RepoPath}} && lazygit
      name: lazygit
  prs:
    - key: D
      command: >
        cd {{.RepoPath}} &&
        gh pr checkout {{.PrNumber}} &&
        nvim -c ":DiffviewOpen main...{{.HeadRefName}}"
      name: diff main
    - key: v
      command: >
        gh pr review --repo {{.RepoName}} --approve --body "$(gum input --prompt='Approval Comment: ')" {{.PrNumber}}
      name: approve
    - key: m
      command: >
        gh pr merge --repo {{.RepoName}} {{.PrNumber}} --delete-branch
      name: merge
    - key: M
      command: >
        gh pr merge --repo {{.RepoName}} {{.PrNumber}} --admin --delete-branch
      name: merge (admin)
    - key: n
      command: >
        gh pr merge --repo {{.RepoName}} {{.PrNumber}} --auto --delete-branch
      name: merge (auto)
    - key: N
      command: >
        gh pr merge --repo {{.RepoName}} {{.PrNumber}} --disable-auto
      name: disable auto merge
    - key: C
      command: >
        cd {{.RepoPath}} &&
        gh pr checkout {{.PrNumber}} &&
        nvim
      name: open in nvim
    - key: P
      command: >
        gh pr ready --repo {{.RepoName}} {{.PrNumber}} --undo
      name: move to draft
    - key: T
      name: retrigger workflows
      command: >
        fish -c '
        echo "Getting PR branch name...";
        echo gh pr view {{.PrNumber}} --repo {{.RepoName}} --json headRefName --jq ".headRefName";
        set BRANCH (gh pr view {{.PrNumber}} --repo {{.RepoName}} --json headRefName --jq ".headRefName");
        echo "Branch: $BRANCH";
        echo "Getting latest workflow run ID...";
        set RUN_ID (gh run list --branch $BRANCH --repo {{.RepoName}} --limit 1 --json databaseId --jq ".[0].databaseId");
        echo "Run ID: $RUN_ID";
        echo "Retriggering workflow...";
        gh run rerun --repo {{.RepoName}} $RUN_ID;
        echo "Done!"
        '
  issues:
    - key: C
      command: >
        cd {{.RepoPath}} && nvim
      name: open in nvim
    - key: P
      command: >
        gh issue pin {{.IssueNumber}} --repo {{.RepoName}}
      name: pin issue
theme:
  ui:
    sectionsShowCount: true
    table:
      showSeparators: true
      compact: false
  colors:
    text:
      primary: "#c0caf5"
      secondary: "#7aa2f7"
      inverted: "#1a1b26"
      faint: "#565f89"
      warning: "#f7768e"
      success: "#9ece6a"
    background:
      selected: "#283457"
    border:
      primary: "#7aa2f7"
      secondary: "#3b4261"
      faint: "#292e42"
