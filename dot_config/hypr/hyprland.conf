monitor=,3840x2160,0x0,1.5
monitor=eDP-1,preferred,320x1440,1

# TODO: figure how it should work
# monitor=,preferred,auto,1,mirror,eDP-1

env = XCURSOR_SIZE,16
env = XCURSOR_THEME,Adwaita

# General configuration

input {
    kb_layout = us, hu, dk
    kb_options = altwin:ctrl_win,caps:super,grp:rctrl_rshift_toggle
	repeat_delay = 200
	repeat_rate = 60
	accel_profile = adaptive

    follow_mouse = 1

    touchpad {
        natural_scroll = yes
		scroll_factor = 0.30
    }

    sensitivity = 0
}

device:tpps/2-elan-trackpoint {
	sensitivity = -0.40
}

general {
    gaps_in = 5
    gaps_out = 5
    border_size = 2

	# default colors
    # col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    # col.inactive_border = rgba(595959aa)

	# nightfox colors (cyan and background)
	col.active_border = 0xff63cdcf
    col.inactive_border = 0xff192330

    # layout = dwindle
    layout = master
    cursor_inactive_timeout = 10
}

misc {
    disable_hyprland_logo = true
	key_press_enables_dpms = true
	# enable_swallow = true
	# swallow_regex = ^(kitty)$
}

decoration {
    rounding = 10
    blur = yes
    blur_size = 3
    blur_passes = 1
    blur_new_optimizations = on

    drop_shadow = yes
    shadow_range = 4
    shadow_render_power = 3
    col.shadow = rgba(1a1a1aee)
    dim_inactive = true
    dim_strength = 0.2
}

animations {
    enabled = yes

    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

dwindle {
    pseudotile = yes
    preserve_split = yes
}

master {
	no_gaps_when_only = true
    new_is_master = true
	new_on_top = true
}

gestures {
    workspace_swipe = on
    workspace_swipe_invert = true
    workspace_swipe_distance = 600
    workspace_swipe_min_speed_to_force = 5
}

# Windowrules

windowrulev2 = float, class:^qalculate-gtk$
windowrulev2 = size 50% 60%, class:^qalculate-gtk$
windowrulev2 = center, class:^qalculate-gtk$
windowrulev2 = float, class:^swayimg*
windowrulev2 = size 80% 80%, class:^swayimg*
windowrulev2 = center, class:^swayimg*
windowrulev2 = float, class:^pavucontrol$
windowrulev2 = float, class:^blueman-manager$
windowrulev2 = float, class:^org.kde.kdeconnect.*$
windowrulev2 = float, class:^org.kde.polkit-kde-authentication-agent-1$
windowrulev2 = float, class:^wdisplays$
windowrulev2 = size 60% 60%, class:^wdisplays$
windowrulev2 = center, class:^wdisplays$
windowrulev2 = float, class:^nm-connection-editor$
windowrulev2 = size 60% 50%, class:^nm-connection-editor$
windowrulev2 = center, class:^nm-connection-editor$
windowrulev2 = float, class:^nm-connection-editor$

windowrulev2 = float, class:firefox, title:^Library$

# NOTE: couldn't move this to the specific workspace, without loosing the floating screenshare configuration picker
# windowrulev2 = workspace special, class:firefox, title:^(Firefox ‚Äî Sharing Indicator)$
windowrulev2 = float, class:firefox, title:^(Firefox ‚Äî Sharing Indicator)$
windowrulev2 = size 0% 0%, class:firefox, title:^(Firefox ‚Äî Sharing Indicator)$
windowrulev2 = move 0 0, class:firefox, title:^(Firefox ‚Äî Sharing Indicator)$

windowrulev2 = workspace 2, class:firefox
windowrulev2 = workspace 3, class:Slack
windowrulev2 = workspace 4, class:code-url-handler
windowrulev2 = workspace 5, class:chromium
windowrulev2 = workspace 9, class:Spotify

windowrulev2 = idleinhibit fullscreen, class:firefox
windowrulev2 = idleinhibit fullscreen, class:chromium
windowrulev2 = idleinhibit fullscreen, class:Slack
windowrulev2 = idleinhibit focus,      class:mpv

# Variables

$wallpapers_path = /home/joelazar/pictures/wallpapers

$lock = swaylock --indicator-radius 80 --indicator-thickness 7 --color 192330 --show-failed-attempts --ring-color 2b3b51 --key-hl-color dbc074 --line-color 000000 --font "Roboto Mono" --inside-color 2b3b51 --separator-color 000000 --ring-ver-color 738091 --inside-ver-color 738091 --inside-wrong-color f4a261 --layout-bg-color 192330 --image `find $wallpapers_path -type f | shuf -n 1`

# Keybindings

$mod = SUPER
$win = MOD3
$shift = SHIFT
$ctrl = CTRL
$alt = ALT

# Vim navigation
$left = h
$down = j
$up = k
$right= l


bind = $mod, F1,              exec, kitty nnn
bind = $mod, F2,              exec, firefox
bind = $mod, F3,              exec, slack
bind = $mod, F4,              exec, code
bind = $mod, F5,              exec, chromium
bind = $mod, F9,              exec, ncspot
bind = $mod, F10,             exec, spotify

bind = $mod $shift, n,        exec, networkmanager_dmenu
bind = $mod $shift, b,        exec, bemenu-bluetooth
bind = $mod $shift, e,        exec, shmoji bemenu
bind = $mod, o,               exec, bemenu-bookmark
bind = $mod, c,               exec, clipman pick --tool bemenu --tool-args="-p clipboard"

# Notifications
bind = $mod $ctrl, space,      exec, dunstctl close

# Hide/unhide waybar
bind = $mod $shift, s,        exec, killall -SIGUSR1 waybar

# Screenshot
bind = $mod, Print,			  exec, grim - | swappy -f -
bind = $mod $shift, Print,    exec, grim -g "$(slurp)" - | swappy -f -

# Change focus around
bind = $mod, $left, movefocus, l
bind = $mod, $right, movefocus, r
bind = $mod, $up, movefocus, u
bind = $mod, $down, movefocus, d
# Or use arrow keys
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d

# Move the focused window with the same, but add Shift
bind = $mod $shift, $left, movewindow, l
bind = $mod $shift, $right, movewindow, r
bind = $mod $shift, $up, movewindow, u
bind = $mod $shift, $down, movewindow, d
# Or use arrow keys
bind = $mod $shift, left, movewindow, l
bind = $mod $shift, right, movewindow, r
bind = $mod $shift, up, movewindow, u
bind = $mod $shift, down, movewindow, d

# Move the focused workspace with the same, but add Alt
bind = $mod $alt, $left, movecurrentworkspacetomonitor, l
bind = $mod $alt, $right, movecurrentworkspacetomonitor, r
bind = $mod $alt, $up, movecurrentworkspacetomonitor, u
bind = $mod $alt, $down, movecurrentworkspacetomonitor, d
# Or use arrow keys
bind = $mod $alt, left, movecurrentworkspacetomonitor, l
bind = $mod $alt, right, movecurrentworkspacetomonitor, r
bind = $mod $alt, up, movecurrentworkspacetomonitor, u
bind = $mod $alt, down, movecurrentworkspacetomonitor, d

# Next/previous workspace
bind = $mod, Tab, workspace, e+1
bind = $mod $shift, Tab, workspace, e-1

# Toggle floating mode
bind = $mod $shift, Space, togglefloating
# Move the currently focused window to the scratchpad
bind = $mod $shift, Minus, movetoworkspace, special

# Show or hide the focused scratchpad window
bind = $mod, Minus, togglespecialworkspace

# Reload all resources and outputs
bind = $mod $shift, c, forcerendererreload

# Brightness control
binde = ,       XF86MonBrightnessUp,   exec, brightnessctl set 1%+
binde = ,       XF86MonBrightnessDown, exec, brightnessctl set 1%-
binde = $shift, XF86MonBrightnessUp,   exec, brightnessctl set 10%+
binde = $shift, XF86MonBrightnessDown, exec, brightnessctl set 10%-

# Audio control
bindl  = ,      XF86AudioMute,        exec, pactl set-sink-mute @DEFAULT_SINK@ toggle
bindl  = ,      XF86AudioMicMute,     exec, pactl set-source-mute @DEFAULT_SOURCE@ toggle
bindle = ,      XF86AudioRaiseVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ +5%
bindle = ,      XF86AudioLowerVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ -5%

# Resize mode

$submap_resize = ‚ÜîÔ∏è resize window (h) left, (l) right, (k) up, (j) down
bind = $mod, r, submap, $submap_resize
submap = $submap_resize
    binde = , h, resizeactive, -15 0
    binde = , l, resizeactive, 15 0
    binde = , k, resizeactive, 0 -15
    binde = , j, resizeactive, 0 15

    bind  = , escape, submap, reset
    bind  = , return, submap, reset
submap = reset

# Exit mode

$submap_exit = üèÅ (l) lock, (e) logout, (s) suspend, (r) reboot, (shift+s) shutdown
bind = $mod $shift, delete, submap, $submap_exit
submap = $submap_exit
    bind = ,       e, exit
    bind = ,       l, exec, $lock
    bind = ,       l, submap, reset
    bind = ,       s, exec, systemctl suspend
    bind = ,       s, submap, reset
    bind = ,       r, exec, systemctl reboot
    bind = ,       r, submap, reset
    bind = $shift, s, exec, systemctl poweroff
    bind = $shift, s, submap, reset

    bind = , return, submap, reset
    bind = , escape, submap, reset
submap = reset

bind = $mod, Return, exec, kitty
bind = $mod $shift, Q, killactive
bind = $mod, D, exec, bemenu-run -p launch

bind = $mod, P, pseudo, # dwindle
bind = $mod, J, togglesplit, # dwindle
bind = $mod, F, fullscreen

binde = , XF86AudioRaiseVolume, exec, vol up 5
bindl = , XF86AudioLowerVolume, exec, vol down 5

# clamshell mode
bindl = , switch:on:Lid Switch, exec, hyprctl keyword monitor "eDP-1, disable"
bindl = , switch:off:Lid Switch, exec, hyprctl keyword monitor "eDP-1, preferred, auto, 1"

# Move focus with mod + arrow keys
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d

# Switch workspaces with mod + [0-9]
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

# Move active window to a workspace with mod + $shift + [0-9]
bind = $mod $shift, 1, movetoworkspace, 1
bind = $mod $shift, 2, movetoworkspace, 2
bind = $mod $shift, 3, movetoworkspace, 3
bind = $mod $shift, 4, movetoworkspace, 4
bind = $mod $shift, 5, movetoworkspace, 5
bind = $mod $shift, 6, movetoworkspace, 6
bind = $mod $shift, 7, movetoworkspace, 7
bind = $mod $shift, 8, movetoworkspace, 8
bind = $mod $shift, 9, movetoworkspace, 9
bind = $mod $shift, 0, movetoworkspace, 10

# Scroll through existing workspaces with mod + scroll
bind = $mod, mouse_down, workspace, e+1
bind = $mod, mouse_up, workspace, e-1

# Move/resize windows with mod + LMB/RMB and dragging
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow

# Autostart
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dunst
exec-once = /usr/lib/polkit-kde-authentication-agent-1
exec-once = waybar
exec-once = wl-paste -t text --watch clipman store --max-items=250
exec-once = blueman-applet
exec-once = gammastep-indicator
exec-once = kdeconnect-indicator
exec-once = batsignal -b -c 10 -d 5 -D "systemctl suspend"
exec-once = swaybg -i `find $wallpapers_path -type f | shuf -n 1`
exec-once = swayidle -w timeout 180 'brightnessctl set 20%-' resume 'brightnessctl set 20%+' timeout 300 '$lock &' timeout 480 'hyprctl keyword monitor ", disable"' resume 'hyprctl keyword monitor ", enable"' timeout 3600 'systemctl suspend' resume 'hyprctl keyword monitor ", enable"' before-sleep 'playerctl pause' before-sleep '$lock'
