#!/bin/bash

SOURCE_DIR=$(chezmoi source-path)

. "$SOURCE_DIR/scripts/utils_install" &&
	. "$SOURCE_DIR/scripts/utils"

print_in_purple "Update yay packages\n"
update

print_in_purple "Update nnn plugins\n"
install_nnn_plugins

print_in_purple "Update fish\n"
update_fish_plugins
execute "fish -c 'fish_update_completions'" "Update fish completions"

print_in_purple "Update neovim plugins\n"
execute "nvim --headless \"+Lazy! update\" +qa" "Update neovim plugins"

print_in_purple "Update npm packages\n"
execute "npm update -g" "Update NPM packages"

print_in_purple "Update tldr cache\n"
execute "tldr -u" "Update tldr cache"

print_in_purple "Update gh extensions\n"
execute "gh extension upgrade --all" "Update gh extensions"

print_in_purple "Update gcloud cli\n"
execute "sudo gcloud components update --quiet" "Update gcloud cli"

print_in_purple "Update firmwares\n"
ask_for_confirmation "Would you like to do it now? It can take a bit of time."
if answer_is_yes; then
	fwupdmgr refresh
	fwupdmgr update
fi

print_in_purple "Update hosts\n"
ask_for_confirmation "Would you like to do it now? Latest hosts will be fetched from https://github.com/StevenBlack/hosts."
if answer_is_yes; then
	update_hosts
fi

clean_up_cache
clean_up_unused_packages
